<%- model_class = Tender -%>

<% content_for :header do %>
  <%= render partial: "layouts/header", locals: {active_tab: model_class} %>
<% end %>

<% content_for :content do %>
  <div id="navigation-view">
    <div id="navigation-bar" class="container-fluid">
      <div class="row">
        <div class="col-xs-3">
          <h3 style="margin-top: auto;"><%= t('.title', :default => Tender.model_name.human.titleize) %></h3>
        </div>
        <div class="col-xs-5">
          <%= render partial: "tab_bar", locals: {active_tab: 'Info', tender: @tender} %>
        </div>
        <div class="col-xs-4">
          <div class="btn-toolbar pull-right" role="toolbar">
            <div class="btn-group">
              <%= link_to edit_tender_path(@tender), title: "Edit Tender", data: { toggle:"tooltip", placement:"bottom" } do %>
                <i class="fa fa-pencil-square-o fa-3x"></i>
              <% end %>
            </div>
            <div class="btn-group">
              <%= link_to settings_tender_path(@tender), title: "Tender Settings", data: { toggle:"tooltip", placement:"bottom" } do %>
                <i class="fa fa-cog fa-3x"></i>
              <% end %>
            </div>
            <div class="btn-group">
              <%= link_to @tender, :method => 'delete', title: "Delete Tender", data: { toggle:"tooltip", placement:"bottom" }, :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) } do %>
                <i class="fa fa-trash-o fa-3x"></i>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="container-fluid">
      <div class="row">
        <div class="col-md-12">
          <div class="table-responsive">
            <table class="table">
              <tbody>
                <tr>
                  <td class="col-md-3">
                    <h4>Basic</h4>
                  </td>
                  <td class="col-md=9">
                    <dl>
                      <dt><b><%= model_class.human_attribute_name(:name) %></b></dt>
                      <dd><%= @tender.name %></dd>
                    </dl>
                    <dl>
                      <dt><b><%= model_class.human_attribute_name(:work_description) %></b></dt>
                      <dd><%= @tender.work_description %></dd>
                    </dl>
                  </td>
                </tr>
                <tr>
                  <td class="col-md-3">
                    <h4>Relations</h4>
                  </td>
                  <td class="col-md=9">
                    <dl>
                      <dt><b><%= model_class.human_attribute_name(:client_group_id) %></b></dt>
                      <dd><%= @tender.client_group.name %></dd>
                    </dl>
                    <dl>
                      <dt><b><%= model_class.human_attribute_name(:client_subgroup_id) %></b></dt>
                      <dd><%= @tender.client_subgroup.name if @tender.client_subgroup %></dd>
                    </dl>
                    <dl>
                      <dt><b><%= model_class.human_attribute_name(:estimator_id) %></b></dt>
                      <dd><%= @tender.estimator.full_name if @tender.estimator %></dd>
                    </dl>
                    <dl>
                      <dt><b><%= model_class.human_attribute_name(:quantity_surveyor_id) %></b></dt>
                      <dd><%= @tender.quantity_surveyor.full_name if @tender.quantity_surveyor %></dd>
                    </dl>
                    <dl>
                      <dt><b><%= model_class.human_attribute_name(:external_db_id) %></b></dt>
                      <dd><%= @tender.external_db_id %></dd>
                    </dl>
                  </td>
                </tr>
                <tr>
                  <td class="col-md-3">
                    <h4>Status</h4>
                  </td>
                  <td class="col-md=9">
                    <%= render partial: "status", locals: {tender_id: @tender.id} %>
                  </td>
                </tr>
                <tr>
                  <td class="col-md-3">
                    <h4>Address</h4>
                  </td>
                  <td class="col-md=9">
                    <dl>
                      <dt><b><%= model_class.human_attribute_name(:address_line) %></b></dt>
                      <dd><%= @tender.address_line %></dd>
                    </dl>
                    <dl>
                      <dt><b><%= model_class.human_attribute_name(:state_id) %></b></dt>
                      <dd><%= @tender.state.name %></dd>
                    </dl>
                    <dl>
                      <dt><b><%= model_class.human_attribute_name(:suburb_id) %></b></dt>
                      <dd><%= @tender.suburb.name %></dd>
                    </dl>
                    <dl>
                      <dt><b><%= model_class.human_attribute_name(:postcode) %></b></dt>
                      <dd><%= @tender.postcode %></dd>
                    </dl>
                    <dl>
                      <dt><b><%= model_class.human_attribute_name(:region_id) %></b></dt>
                      <dd><%= @tender.region.name %></dd>
                    </dl>
                    <dl>
                      <dt><b><%= model_class.human_attribute_name(:office_id) %></b></dt>
                      <dd><%= @tender.office.name %></dd>
                    </dl>
                  </td>
                </tr>
                <tr>
                  <td class="col-md-3">
                    <h4>Nearby</h4>
                  </td>
                  <td class="col-md=9">
                    <dl>
                      <dt>
                      <b>Nearby Subcontractors</b>
                      <div class="btn-toolbar pull-right" role="toolbar">
                        <%= link_to 'Show on map', "#", :class => 'btn btn-primary' %>
                      </div>
                      </dt>
                      <dd>
                      <ul class="list-unstyled">
                        <% @subcontractors.each do |subcontractor| %>
                          <li><%= link_to subcontractor.name, subcontractor %> (<%= number_to_human(subcontractor.distance, units: "geocoder.distance") %>)</li>
                        <% end %>
                      </ul>
                      </dd>
                    </dl>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
<% end %>

<%= render template: "layouts/app" %>
